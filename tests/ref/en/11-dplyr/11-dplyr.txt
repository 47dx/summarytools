
# -------------------------------- dplyr.R -------------------------------------  

> library(dplyr) 
> library(summarytools) 
> library(magrittr) 
> library(dplyr) 
> data(tobacco) 
> tobacco %>% select(age.gr, smoker) %>% freq() %>% view() 
-- Output file written
-- Output file appended

> tobacco$age.gr %<>% forcats::fct_explicit_na() 
> (tmp <- tobacco %>% group_by(age.gr) %>% select(age.gr, smoker) %>% freq()) 

Frequencies  
tobacco$smoker  
Type: Factor  
Group: age.gr = 18-34  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
        Yes     74     28.68          28.68     28.68          28.68
         No    184     71.32         100.00     71.32         100.00
       <NA>      0                               0.00         100.00
      Total    258    100.00         100.00    100.00         100.00

Group: age.gr = 35-50  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
        Yes     72     29.88          29.88     29.88          29.88
         No    169     70.12         100.00     70.12         100.00
       <NA>      0                               0.00         100.00
      Total    241    100.00         100.00    100.00         100.00

Group: age.gr = 51-70  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
        Yes     99     31.23          31.23     31.23          31.23
         No    218     68.77         100.00     68.77         100.00
       <NA>      0                               0.00         100.00
      Total    317    100.00         100.00    100.00         100.00

Group: age.gr = 71 +  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
        Yes     45     28.30          28.30     28.30          28.30
         No    114     71.70         100.00     71.70         100.00
       <NA>      0                               0.00         100.00
      Total    159    100.00         100.00    100.00         100.00

Group: age.gr = (Missing)  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
        Yes      8     32.00          32.00     32.00          32.00
         No     17     68.00         100.00     68.00         100.00
       <NA>      0                               0.00         100.00
      Total     25    100.00         100.00    100.00         100.00

> print(tmp, file = "01-group_by_freq.html") 
-- Switching method to 'browser'
-- Output file written
-- Output file appended

> tmp %>% tb() 

# A tibble: 15 x 7
   value smoker  freq pct_valid
   <fct> <fct>  <dbl>     <dbl>
 1 18-34 Yes       74      5.74
 2 18-34 No       184     14.3 
 3 18-34 <NA>       0     NA   
 4 35-50 Yes       72      5.98
 5 35-50 No       169     14.0 
 6 35-50 <NA>       0     NA   
 7 51-70 Yes       99      6.25
 8 51-70 No       218     13.8 
 9 51-70 <NA>       0     NA   
10 71 +  Yes       45      5.66
11 71 +  No       114     14.3 
12 71 +  <NA>       0     NA   
13 (Mis~ Yes        8      6.4 
14 (Mis~ No        17     13.6 
15 (Mis~ <NA>       0     NA   
# ... with 3 more variables:
#   pct_valid_cum <dbl>, pct_tot <dbl>,
#   pct_tot_cum <dbl>

> tobacco %>% descr() 
-- Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease

Descriptive Statistics  

                       age      BMI   cigs.per.day   samp.wgts
----------------- -------- -------- -------------- -----------
             Mean    49.60    25.73           6.78        1.00
          Std.Dev    18.29     4.49          11.88        0.08
              Min    18.00     8.83           0.00        0.86
               Q1    34.00    22.93           0.00        0.86
           Median    50.00    25.62           0.00        1.04
               Q3    66.00    28.65          11.00        1.05
              Max    80.00    39.44          40.00        1.06
              MAD    23.72     4.18           0.00        0.01
              IQR    32.00     5.72          11.00        0.19
               CV     0.37     0.17           1.75        0.08
         Skewness    -0.04     0.02           1.54       -1.04
      SE.Skewness     0.08     0.08           0.08        0.08
         Kurtosis    -1.26     0.26           0.90       -0.90
          N.Valid   975.00   974.00         965.00     1000.00
        Pct.Valid    97.50    97.40          96.50      100.00

> tobacco %>% select(age, BMI, smoker) %>% descr(stats = "fivenum") 
-- Non-numerical variable(s) ignored: smoker

Descriptive Statistics  
tobacco  
N: 1000  

                 age     BMI
------------ ------- -------
         Min   18.00    8.83
          Q1   34.00   22.93
      Median   50.00   25.62
          Q3   66.00   28.65
         Max   80.00   39.44

> tobacco %>% filter(smoker == "Yes") %>% descr(stats = "common") 
-- Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease

Descriptive Statistics  
tobacco  
N: 298  

                     age      BMI   cigs.per.day   samp.wgts
--------------- -------- -------- -------------- -----------
           Mean    49.76    25.64          22.49        1.00
        Std.Dev    18.75     4.25          10.69        0.08
            Min    19.00     9.01           5.00        0.86
         Median    50.00    25.70          22.00        1.04
            Max    80.00    36.36          40.00        1.06
        N.Valid   290.00   291.00         291.00      298.00
      Pct.Valid    97.32    97.65          97.65      100.00

> tobacco %>% group_by(smoker) %>% descr(stats = "common") %>% view() 
-- Non-numerical variable(s) ignored: gender, age.gr, smoker, diseased, disease
-- Output file written
-- Output file appended

> tobacco %$% descr(age) 

Descriptive Statistics  
tobacco$age  
N: 1000  

                       age
----------------- --------
             Mean    49.60
          Std.Dev    18.29
              Min    18.00
               Q1    34.00
           Median    50.00
               Q3    66.00
              Max    80.00
              MAD    23.72
              IQR    32.00
               CV     0.37
         Skewness    -0.04
      SE.Skewness     0.08
         Kurtosis    -1.26
          N.Valid   975.00
        Pct.Valid    97.50

> tobacco %>% dfSummary() %>% view() 
-- Output file written

> tobacco %>% select(gender, age, BMI, smoker) %>% dfSummary() 

Data Frame Summary  
tobacco  
Dimensions: 1000 x 4  
Duplicates: 2  

----------------------------------------------------------------------------------------------------------
No   Variable    Stats / Values            Freqs (% of Valid)    Graph                 Valid     Missing  
---- ----------- ------------------------- --------------------- --------------------- --------- ---------
1    gender      1. F                      489 (50.0%)           IIIIIIIIII            978       22       
     [factor]    2. M                      489 (50.0%)           IIIIIIIIII            (97.8%)   (2.2%)   

2    age         Mean (sd) : 49.6 (18.3)   63 distinct values    .     .     . . . :   975       25       
     [numeric]   min < med < max:                                : : : : : . : : : :   (97.5%)   (2.5%)   
                 18 < 50 < 80                                    : : : : : : : : : :                      
                 IQR (CV) : 32 (0.4)                             : : : : : : : : : :                      
                                                                 : : : : : : : : : :                      

3    BMI         Mean (sd) : 25.7 (4.5)    974 distinct values             :           974       26       
     [numeric]   min < med < max:                                        : : :         (97.4%)   (2.6%)   
                 8.8 < 25.6 < 39.4                                       : : :                            
                 IQR (CV) : 5.7 (0.2)                                  : : : : :                          
                                                                     . : : : : : .                        

4    smoker      1. Yes                    298 (29.8%)           IIIII                 1000      0        
     [factor]    2. No                     702 (70.2%)           IIIIIIIIIIIIII        (100%)    (0%)     
----------------------------------------------------------------------------------------------------------

> tobacco %>% group_by(gender) %>% dfSummary() %>% view() 
-- Output file written
-- Output file appended

